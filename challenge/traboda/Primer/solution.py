from Crypto.PublicKey import RSA
from Crypto.Util.number import *
from sympy import factorint
import base64
key = RSA.importKey(open("pub.pem").read())

n = key.n
e = key.e
#[*] monoprime factored using factorint
p = 36511974694593690272644354864534934200522045623187752384823594729275730789191680514905027084950729514148679507005058047146031869995768765034876499069680202424692876360895377987654388335335689563844006584610187090074654410815638237841872991488680663410743679302763304922852173164820002226109196761249018548478251723505481964749218302723593776180246783117481280725673997940309717028451914887375722437833384305529884261542397905220138488012276363046571670926597766521674838665982314321651508118240682649024780239598188845543243957916954287138820155843952556411235376764737602711594439293285811102883736229645274092478611L

phi = (p-1)

with open("flag.enc") as f:
	flag = f.read().strip("\n")

flag = int(base64.b64decode(flag))

d = inverse(e,phi)

m = pow(flag,d,n)

print(long_to_bytes(m))